<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:int="http://www.springframework.org/schema/integration"
       xmlns:int-file="http://www.springframework.org/schema/integration/file"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans.xsd
           http://www.springframework.org/schema/integration
           http://www.springframework.org/schema/integration/spring-integration-4.1.xsd
           http://www.springframework.org/schema/integration/file
           http://www.springframework.org/schema/integration/file/spring-integration-file-4.1.xsd">
       
    <bean id="placeholderConfig" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"> 
		<property name="location" value="classpath:config.properties"/>
	</bean>   
	 
    <int-file:inbound-channel-adapter 
		channel="fileChannelEntree"
    	directory="${inputdata.folder}"
    	filename-pattern="*.txt">
    		<int:poller id="poller" fixed-delay="1000" />
    </int-file:inbound-channel-adapter>
    
    <int:channel id="fileChannelEntree"></int:channel>
    
    <int-file:file-to-string-transformer input-channel="fileChannelEntree" output-channel="fileChannelStringOutput"/>
    
    <int:channel id="fileChannelStringOutput"></int:channel>
    
   <int:service-activator  
	input-channel="fileChannelStringOutput"
	output-channel="serviceActivatorsortie"
	ref="myServiceBean"
	method="myMethod">
	</int:service-activator>

	<bean id="myServiceBean" class="myPackage.MyServiceToJSon"></bean>

	<int:channel id="serviceActivatorsortie"></int:channel>
	
	<int:object-to-json-transformer input-channel="serviceActivatorsortie" output-channel="objectJSonConverter" />

    <int:channel id="objectJSonConverter"></int:channel>
    
    <int-file:outbound-channel-adapter 
    	channel="objectJSonConverter"
    	directory="${outputdata.folder}"/>
       
</beans>
